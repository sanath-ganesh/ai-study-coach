---chunk-0---
Lecture 28: Faster Sorting Methods - 1 Materials are edited by Prof. Jones Yu fromData Structures and Abstractions with Java, 5th edition. By Frank M. Carrano and Timothy M. Henry. ISBN-13 978-0-13-483169-5 © 2019 Pearson Education, Inc. Prof. Chen-Hsiang (Jones) Yu, Ph.D.College of Engineering Merge Sort 3INFO 6205 -ProgramStructureand AlgorithmsFall 2024 §Divides an array into halves§Sorts the two halves, −Then merges them into one sorted array. §The algorithm for merge sort is usually stated recursively.§Major programming effort is in the merge process. Merge Sort 4INFO 6205 -ProgramStructureand AlgorithmsFall 2024Figure 16-1: Merging two sorted arrays into one sorted array Merging Arrays 5INFO 6205 -ProgramStructureand AlgorithmsFall 2024Figure 16-2: The major steps in a merge sort Recursive Merge Sort 6INFO 6205 -ProgramStructureand AlgorithmsFall 2024 Recursive algorithm for merge sort Recursive Merge SortAlgorithmmergeSort(a, tempArray, first, last)// Sorts the array entries a[first..last] recursively.if (first < last){ mid=approximate midpointbetweenfirst andlast mergeSort(a, tempArray, first, mid)mergeSort(a, tempArray, mid + 1,last)Merge the sorted halvesa[first..mid] and a[mid+1..last]using the array tempArray} Pseudocode describes the merge step Algorithm merge(a, tempArray, first, mid, last)// Merges the adjacent subarrays a[first..mid] and a[mid+1..last].beginHalf1 = first, endHalf1 = mid, beginHalf2 = mid + 1,endHalf2 = last// While both subarrays are not empty, compare an entry in one subarray with // an entry in the other; then copy the smaller item into the temporary arrayindex = 0 //Next available location in tempArraywhile ( (beginHalf1 <= endHalf1) and (beginHalf2 <= endHalf2) ){ if (a[beginHalf1] <= a[beginHalf2]){ tempArray[index]=a[beginHalf1] beginHalf1++ } else{ tempArray[index]=a[beginHalf2] beginHalf2++ } index++}// Assertion: One subarray has been completely copied to tempArray. Copy remaining entries from other subarray to tempArray Copy entries from tempArray to array a 8INFO 6205 -ProgramStructureand AlgorithmsFall 2024Figure 16-3: The effect of the recursive calls and the merges during a merge sort Recursive Merge Sort 9INFO 6205 -ProgramStructureand AlgorithmsFall 2024 Be careful to allocate the temporary array only once Recursive Merge Sort publicstatic<T extendsComparable<? superT>>voidmergeSort(T[] a, intfirst, intlast){// The cast is safe because the new array contains null entries@SuppressWarnings("unchecked")T[] tempArray= (T[])newComparable<?>[a.length]; // Unchecked cast mergeSort(a, tempArray, first, last);} // end mergeSort 10INFO 6205 -ProgramStructureand AlgorithmsFall 2024 Figure 16-4: A worst-case merge of two sorted arrays. Efficiency is O(n log n).Note that the proof is in section 16.6. Efficiency of Merge Sort 11INFO 6205 -ProgramStructureand AlgorithmsFall 2024 §Less simple than recursive version−Need to control the merges§Will be more efficient of both time and space−But, trickier to code without error Iterative Merge Sort 12INFO 6205 -ProgramStructureand AlgorithmsFall 2024 §Starts at beginning of array−Merges pairs of individual entries to form two-entry subarrays§Returns to the beginning of array and merges pairs of the two-entry subarrays to form four-entry subarrays−And so on§After merging all pairs of subarrays of a particular length, might have entries left over. Iterative Merge Sort (cont.) 13INFO 6205 -ProgramStructureand AlgorithmsFall 2024 §Suppose following list represents an array of Integer objects. §Show the steps that a merge sort takes when sorting this array. 80 90 70 85 60 40 50 95 Exercise 14INFO 6205 -ProgramStructureand AlgorithmsFall 2024 §Split the array in half until we reach single-element subarrays:80 90 70 85 60 40 50 9580 90 70 85 60 40 50 9580 90 70 85 60 40 50 9580 90 70 85 60 40 50 95§Merge pairs of subarrays to produce larger sorted subarrays:80 90 70 85 40 60 50 9570 80 85 90 40 50 60 9540 50 60 70 80 85 90 95 Answer 15INFO 6205 -ProgramStructureand AlgorithmsFall 2024 §Class Arrays in the package java.util defines versions of a static method sort Merge Sort in the Java Class Library publicstaticvoidsort(Object[] a)publicstaticvoidsort(Object[] a, intfirst, intafter) 16INFO 6205 -ProgramStructureand AlgorithmsFall 2024 §Please download “L28_E1” project from “In-class Exercises” on the Canvas.§Please finish methods mergeSort() and merge(), and run Merge Sort to a given sequence of integers. (ArraySortRecursive.java)Note: You should use merge() in mergeSort() to support the sorting. Exercise (10-15 mins) 17INFO 6205 -ProgramStructureand AlgorithmsFall 2024 Expected Result Running Merge Sort: Before sort:11 2 5 7 9 21 8 18 24 10 After sort:2 5 7 8 9 10 11 18 21 24 18INFO 6205 -ProgramStructureand AlgorithmsFall 2024 Answerprivate static <T extends Comparable<? super T>>voidmergeSort(T[] a, T[] tempArray, intfirst, intlast){ if (first < last) { int mid = first + (last - first) / 2; // Index of midpoint mergeSort(a, first, mid); // Sort left half array mergeSort(a, mid + 1, last); // Sort right half array merge(a, tempArray, first, mid, last); // Merge the two halves }} 19INFO 6205 -ProgramStructureand AlgorithmsFall 2024 Answer (cont.)privatestatic<T extendsComparable<? superT>> voidmerge(T[] a, T[] tempArray, intfirst, intmid, intlast){intbeginHalf1= first;intendHalf1= mid;intbeginHalf2= mid+ 1;intendHalf2= last;intindex= beginHalf1;for(; (beginHalf1<= endHalf1) && (beginHalf2<= endHalf2); index++){ if(a[beginHalf1].compareTo(a[beginHalf2]) < 0){ tempArray[index] = a[beginHalf1];beginHalf1++;}else { tempArray[index] = a[beginHalf2];beginHalf2++;} // end if} // end forfor(; beginHalf1<= endHalf1; beginHalf1++, index++)tempArray[index] = a[beginHalf1];for(; beginHalf2<= endHalf2; beginHalf2++, index++)tempArray[index] = a[beginHalf2];for(index= first; index<= last; index++)a[index] = tempArray[index];} // end merge
